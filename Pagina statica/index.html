<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>Bootstrap 101 Template</title>

    <!-- Bootstrap -->

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
  <body>
    
    <table id="servicos">
        <thead>
            <tr>
                <th>Id</th>
                <th>Nome</th>
                <th>Ativo</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td></td>
                <td></td>
                <td></td>
            </tr>
        </tbody>
    </table>

    <script src="jquery-3.0.0.js"></script>
    <script>
    $(document).ready(function(){

            var loginOauth = {
                "async": true,
                "crossDomain": true,
                "url": "http://localhost:8080/oauth/token?grant_type=password&username=tiago&password=123",
                "method": "POST",
                "headers": {
                    "Authorization": "Basic c2Vydmljb3M6MTIzNA==",
                    "Content-type": "application/x-www-form-urlencoded; charset=utf-8"
                }
            }
            var servico = {
                "async": true,
                "crossDomain": true,
                "url": "http://localhost:8080/servicos",
                "method": "GET",
                "headers": {
                    "Authorization": "Basic bXktdHJ1c3RlZC1jbGllbnQ6c2VjcmV0",
                }
            }

        $.ajax(loginOauth).done(function (response) {
            servico.headers.Authorization = response.token_type+" "+response.access_token; 
            
            $.ajax(servico).done(function (response) {
                
                    var td = document.getElementsByTagName("td");
                    td[0].innerText = response.id;
                    td[1].innerText = response.nome;
                    td[2].innerText = response.ativo;

                console.log(response);
            });
        });

    });

    </script>

  </body>
</html>